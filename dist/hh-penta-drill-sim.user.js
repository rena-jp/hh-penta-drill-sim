// ==UserScript==
// @name         Hentai Heroes Penta Drill Sim
// @namespace    https://github.com/rena-jp/hh-penta-drill-sim
// @version      0.0.4
// @description  Add Penta Drill simulator for Hentai Heroes
// @author       rena
// @match        https://*.hentaiheroes.com/*
// @match        https://nutaku.haremheroes.com/*
// @match        https://*.gayharem.com/*
// @match        https://*.comixharem.com/*
// @match        https://*.pornstarharem.com/*
// @match        https://*.transpornstarharem.com/*
// @match        https://*.gaypornstarharem.com/*
// @match        https://*.mangarpg.com/*
// @grant        none
// @run-at       document-body
// @updateURL    https://github.com/rena-jp/hh-penta-drill-sim/raw/main/dist/hh-penta-drill-sim.meta.js
// @downloadURL  https://github.com/rena-jp/hh-penta-drill-sim/raw/main/dist/hh-penta-drill-sim.user.js
// ==/UserScript==

"use strict";(()=>{var Vt=Object.defineProperty;var oe=(e,t)=>{for(var r in t)Vt(e,r,{get:t[r],enumerable:!0})};var tt=["darkness","light","psychic","water","fire","nature","stone","sun"];var rt=[1,2,3,4,5,6,9,10],ie={Masochist:1,Spermcaster:2,Dominator:3,Fluffer:4,Corkscrewer:5,Bugger:6,Pleasurelock:9,Sexomancer:10};var nt={punch:"Spank!",heal_up:"Recovery",mana_steal:"Mana Steal",shield_many:"Shields Up",burn:"Burnout!",mana_boost:"Mana Boost",defenses_up:"Reassurance",stun_many:"Lovestruck",light_punch:"No Skill",necro_revive:"Sexomancer"},ot={darkness:"punch",light:"heal_up",psychic:"mana_steal",water:"shield_many",fire:"burn",nature:"mana_boost",stone:"defenses_up",sun:"stun_many"};var Ve={};oe(Ve,{AddResoureBarModule:()=>Dt,CompactRewardsModule:()=>Bt,FasterSkipButtonModule:()=>It,PentaDrillSimModule:()=>Xt,TeamEditingTweaksModule:()=>zt});var Te,d,ut,er,q,it,ct,mt,ft,Me,ke,Se,tr,we={},pt=[],rr=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,de=Array.isArray;function B(e,t){for(var r in t)e[r]=t[r];return e}function Ce(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function dt(e,t,r){var o,i,n,a={};for(n in t)n=="key"?o=t[n]:n=="ref"?i=t[n]:a[n]=t[n];if(arguments.length>2&&(a.children=arguments.length>3?Te.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(n in e.defaultProps)a[n]===void 0&&(a[n]=e.defaultProps[n]);return me(e,a,o,i,null)}function me(e,t,r,o,i){var n={type:e,props:t,key:r,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++ut,__i:-1,__u:0};return i==null&&d.vnode!=null&&d.vnode(n),n}function R(e){return e.children}function fe(e,t){this.props=e,this.context=t}function Q(e,t){if(t==null)return e.__?Q(e.__,e.__i+1):null;for(var r;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?Q(e):null}function _t(e){var t,r;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null){e.__e=e.__c.base=r.__e;break}return _t(e)}}function at(e){(!e.__d&&(e.__d=!0)&&q.push(e)&&!pe.__r++||it!=d.debounceRendering)&&((it=d.debounceRendering)||ct)(pe)}function pe(){for(var e,t,r,o,i,n,a,l=1;q.length;)q.length>l&&q.sort(mt),e=q.shift(),l=q.length,e.__d&&(r=void 0,o=void 0,i=(o=(t=e).__v).__e,n=[],a=[],t.__P&&((r=B({},o)).__v=o.__v+1,d.vnode&&d.vnode(r),bt(t.__P,r,o,t.__n,t.__P.namespaceURI,32&o.__u?[i]:null,n,i??Q(o),!!(32&o.__u),a),r.__v=o.__v,r.__.__k[r.__i]=r,ir(n,r,a),o.__e=o.__=null,r.__e!=i&&_t(r)));pe.__r=0}function ht(e,t,r,o,i,n,a,l,c,u,f){var s,y,p,x,g,_,b,m=o&&o.__k||pt,k=t.length;for(c=nr(r,t,m,c,k),s=0;s<k;s++)(p=r.__k[s])!=null&&(y=p.__i==-1?we:m[p.__i]||we,p.__i=s,_=bt(e,p,y,i,n,a,l,c,u,f),x=p.__e,p.ref&&y.ref!=p.ref&&(y.ref&&Re(y.ref,null,p),f.push(p.ref,p.__c||x,p)),g==null&&x!=null&&(g=x),(b=!!(4&p.__u))||y.__k===p.__k?c=gt(p,c,e,b):typeof p.type=="function"&&_!==void 0?c=_:x&&(c=x.nextSibling),p.__u&=-7);return r.__e=g,c}function nr(e,t,r,o,i){var n,a,l,c,u,f=r.length,s=f,y=0;for(e.__k=new Array(i),n=0;n<i;n++)(a=t[n])!=null&&typeof a!="boolean"&&typeof a!="function"?(typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?a=e.__k[n]=me(null,a,null,null,null):de(a)?a=e.__k[n]=me(R,{children:a},null,null,null):a.constructor==null&&a.__b>0?a=e.__k[n]=me(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):e.__k[n]=a,c=n+y,a.__=e,a.__b=e.__b+1,l=null,(u=a.__i=or(a,r,c,s))!=-1&&(s--,(l=r[u])&&(l.__u|=2)),l==null||l.__v==null?(u==-1&&(i>f?y--:i<f&&y++),typeof a.type!="function"&&(a.__u|=4)):u!=c&&(u==c-1?y--:u==c+1?y++:(u>c?y--:y++,a.__u|=4))):e.__k[n]=null;if(s)for(n=0;n<f;n++)(l=r[n])!=null&&(2&l.__u)==0&&(l.__e==o&&(o=Q(l)),vt(l,l));return o}function gt(e,t,r,o){var i,n;if(typeof e.type=="function"){for(i=e.__k,n=0;i&&n<i.length;n++)i[n]&&(i[n].__=e,t=gt(i[n],t,r,o));return t}e.__e!=t&&(o&&(t&&e.type&&!t.parentNode&&(t=Q(e)),r.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function or(e,t,r,o){var i,n,a,l=e.key,c=e.type,u=t[r],f=u!=null&&(2&u.__u)==0;if(u===null&&l==null||f&&l==u.key&&c==u.type)return r;if(o>(f?1:0)){for(i=r-1,n=r+1;i>=0||n<t.length;)if((u=t[a=i>=0?i--:n++])!=null&&(2&u.__u)==0&&l==u.key&&c==u.type)return a}return-1}function lt(e,t,r){t[0]=="-"?e.setProperty(t,r??""):e[t]=r==null?"":typeof r!="number"||rr.test(t)?r:r+"px"}function ce(e,t,r,o,i){var n,a;e:if(t=="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof o=="string"&&(e.style.cssText=o=""),o)for(t in o)r&&t in r||lt(e.style,t,"");if(r)for(t in r)o&&r[t]==o[t]||lt(e.style,t,r[t])}else if(t[0]=="o"&&t[1]=="n")n=t!=(t=t.replace(ft,"$1")),a=t.toLowerCase(),t=a in e||t=="onFocusOut"||t=="onFocusIn"?a.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+n]=r,r?o?r.u=o.u:(r.u=Me,e.addEventListener(t,n?Se:ke,n)):e.removeEventListener(t,n?Se:ke,n);else{if(i=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&r==1?"":r))}}function st(e){return function(t){if(this.l){var r=this.l[t.type+e];if(t.t==null)t.t=Me++;else if(t.t<r.u)return;return r(d.event?d.event(t):t)}}}function bt(e,t,r,o,i,n,a,l,c,u){var f,s,y,p,x,g,_,b,m,k,G,H,F,D,O,I,ne,w=t.type;if(t.constructor!=null)return null;128&r.__u&&(c=!!(32&r.__u),n=[l=t.__e=r.__e]),(f=d.__b)&&f(t);e:if(typeof w=="function")try{if(b=t.props,m="prototype"in w&&w.prototype.render,k=(f=w.contextType)&&o[f.__c],G=f?k?k.props.value:f.__:o,r.__c?_=(s=t.__c=r.__c).__=s.__E:(m?t.__c=s=new w(b,G):(t.__c=s=new fe(b,G),s.constructor=w,s.render=lr),k&&k.sub(s),s.state||(s.state={}),s.__n=o,y=s.__d=!0,s.__h=[],s._sb=[]),m&&s.__s==null&&(s.__s=s.state),m&&w.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=B({},s.__s)),B(s.__s,w.getDerivedStateFromProps(b,s.__s))),p=s.props,x=s.state,s.__v=t,y)m&&w.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),m&&s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(m&&w.getDerivedStateFromProps==null&&b!==p&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(b,G),t.__v==r.__v||!s.__e&&s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(b,s.__s,G)===!1){for(t.__v!=r.__v&&(s.props=b,s.state=s.__s,s.__d=!1),t.__e=r.__e,t.__k=r.__k,t.__k.some(function(N){N&&(N.__=t)}),H=0;H<s._sb.length;H++)s.__h.push(s._sb[H]);s._sb=[],s.__h.length&&a.push(s);break e}s.componentWillUpdate!=null&&s.componentWillUpdate(b,s.__s,G),m&&s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(p,x,g)})}if(s.context=G,s.props=b,s.__P=e,s.__e=!1,F=d.__r,D=0,m){for(s.state=s.__s,s.__d=!1,F&&F(t),f=s.render(s.props,s.state,s.context),O=0;O<s._sb.length;O++)s.__h.push(s._sb[O]);s._sb=[]}else do s.__d=!1,F&&F(t),f=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++D<25);s.state=s.__s,s.getChildContext!=null&&(o=B(B({},o),s.getChildContext())),m&&!y&&s.getSnapshotBeforeUpdate!=null&&(g=s.getSnapshotBeforeUpdate(p,x)),I=f,f!=null&&f.type===R&&f.key==null&&(I=yt(f.props.children)),l=ht(e,de(I)?I:[I],t,r,o,i,n,a,l,c,u),s.base=t.__e,t.__u&=-161,s.__h.length&&a.push(s),_&&(s.__E=s.__=null)}catch(N){if(t.__v=null,c||n!=null)if(N.then){for(t.__u|=c?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;n[n.indexOf(l)]=null,t.__e=l}else{for(ne=n.length;ne--;)Ce(n[ne]);Pe(t)}else t.__e=r.__e,t.__k=r.__k,N.then||Pe(t);d.__e(N,t,r)}else n==null&&t.__v==r.__v?(t.__k=r.__k,t.__e=r.__e):l=t.__e=ar(r.__e,t,r,o,i,n,a,c,u);return(f=d.diffed)&&f(t),128&t.__u?void 0:l}function Pe(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Pe)}function ir(e,t,r){for(var o=0;o<r.length;o++)Re(r[o],r[++o],r[++o]);d.__c&&d.__c(t,e),e.some(function(i){try{e=i.__h,i.__h=[],e.some(function(n){n.call(i)})}catch(n){d.__e(n,i.__v)}})}function yt(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:de(e)?e.map(yt):B({},e)}function ar(e,t,r,o,i,n,a,l,c){var u,f,s,y,p,x,g,_=r.props||we,b=t.props,m=t.type;if(m=="svg"?i="http://www.w3.org/2000/svg":m=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),n!=null){for(u=0;u<n.length;u++)if((p=n[u])&&"setAttribute"in p==!!m&&(m?p.localName==m:p.nodeType==3)){e=p,n[u]=null;break}}if(e==null){if(m==null)return document.createTextNode(b);e=document.createElementNS(i,m,b.is&&b),l&&(d.__m&&d.__m(t,n),l=!1),n=null}if(m==null)_===b||l&&e.data==b||(e.data=b);else{if(n=n&&Te.call(e.childNodes),!l&&n!=null)for(_={},u=0;u<e.attributes.length;u++)_[(p=e.attributes[u]).name]=p.value;for(u in _)if(p=_[u],u!="children"){if(u=="dangerouslySetInnerHTML")s=p;else if(!(u in b)){if(u=="value"&&"defaultValue"in b||u=="checked"&&"defaultChecked"in b)continue;ce(e,u,null,p,i)}}for(u in b)p=b[u],u=="children"?y=p:u=="dangerouslySetInnerHTML"?f=p:u=="value"?x=p:u=="checked"?g=p:l&&typeof p!="function"||_[u]===p||ce(e,u,p,_[u],i);if(f)l||s&&(f.__html==s.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),t.__k=[];else if(s&&(e.innerHTML=""),ht(t.type=="template"?e.content:e,de(y)?y:[y],t,r,o,m=="foreignObject"?"http://www.w3.org/1999/xhtml":i,n,a,n?n[0]:r.__k&&Q(r,0),l,c),n!=null)for(u=n.length;u--;)Ce(n[u]);l||(u="value",m=="progress"&&x==null?e.removeAttribute("value"):x!=null&&(x!==e[u]||m=="progress"&&!x||m=="option"&&x!=_[u])&&ce(e,u,x,_[u],i),u="checked",g!=null&&g!=e[u]&&ce(e,u,g,_[u],i))}return e}function Re(e,t,r){try{if(typeof e=="function"){var o=typeof e.__u=="function";o&&e.__u(),o&&t==null||(e.__u=e(t))}else e.current=t}catch(i){d.__e(i,r)}}function vt(e,t,r){var o,i;if(d.unmount&&d.unmount(e),(o=e.ref)&&(o.current&&o.current!=e.__e||Re(o,null,t)),(o=e.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(n){d.__e(n,t)}o.base=o.__P=null}if(o=e.__k)for(i=0;i<o.length;i++)o[i]&&vt(o[i],t,r||typeof e.type!="function");r||Ce(e.__e),e.__c=e.__=e.__e=void 0}function lr(e,t,r){return this.constructor(e,r)}Te=pt.slice,d={__e:function(e,t,r,o){for(var i,n,a;t=t.__;)if((i=t.__c)&&!i.__)try{if((n=i.constructor)&&n.getDerivedStateFromError!=null&&(i.setState(n.getDerivedStateFromError(e)),a=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(e,o||{}),a=i.__d),a)return i.__E=i}catch(l){e=l}throw e}},ut=0,er=function(e){return e!=null&&e.constructor==null},fe.prototype.setState=function(e,t){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=B({},this.state),typeof e=="function"&&(e=e(B({},r),this.props)),e&&B(r,e),e!=null&&this.__v&&(t&&this._sb.push(t),at(this))},fe.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),at(this))},fe.prototype.render=R,q=[],ct=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,mt=function(e,t){return e.__v.__b-t.__v.__b},pe.__r=0,ft=/(PointerCapture)$|Capture$/i,Me=0,ke=st(!1),Se=st(!0),tr=0;var sr="diffed",xt="__c",Ee="__s",K="__c",Rt="__k",Le="__d",X="__s",kt=/[\s\n\\/='"\0<>]/,St=/^(xlink|xmlns|xml)([A-Z])/,ur=/^(?:accessK|auto[A-Z]|cell|ch|col|cont|cross|dateT|encT|form[A-Z]|frame|hrefL|inputM|maxL|minL|noV|playsI|popoverT|readO|rowS|src[A-Z]|tabI|useM|item[A-Z])/,cr=/^ac|^ali|arabic|basel|cap|clipPath$|clipRule$|color|dominant|enable|fill|flood|font|glyph[^R]|horiz|image|letter|lighting|marker[^WUH]|overline|panose|pointe|paint|rendering|shape|stop|strikethrough|stroke|text[^L]|transform|underline|unicode|units|^v[^i]|^w|^xH/,mr=new Set(["draggable","spellcheck"]);function Et(e){e.__g!==void 0?e.__g|=8:e[Le]=!0}function fr(e){e.__g!==void 0?e.__g&=-9:e[Le]=!1}function wt(e){return e.__g!==void 0?!!(8&e.__g):e[Le]===!0}var pr=/["&<]/;function _e(e){if(e.length===0||pr.test(e)===!1)return e;for(var t=0,r=0,o="",i="";r<e.length;r++){switch(e.charCodeAt(r)){case 34:i="&quot;";break;case 38:i="&amp;";break;case 60:i="&lt;";break;default:continue}r!==t&&(o+=e.slice(t,r)),o+=i,t=r+1}return r!==t&&(o+=e.slice(t,r)),o}var Pt={},dr=new Set(["animation-iteration-count","border-image-outset","border-image-slice","border-image-width","box-flex","box-flex-group","box-ordinal-group","column-count","fill-opacity","flex","flex-grow","flex-negative","flex-order","flex-positive","flex-shrink","flood-opacity","font-weight","grid-column","grid-row","line-clamp","line-height","opacity","order","orphans","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","widows","z-index","zoom"]),_r=/[A-Z]/g;function hr(e){var t="";for(var r in e){var o=e[r];if(o!=null&&o!==""){var i=r[0]=="-"?r:Pt[r]||(Pt[r]=r.replace(_r,"-$&").toLowerCase()),n=";";typeof o!="number"||i.startsWith("--")||dr.has(i)||(n="px;"),t=t+i+":"+o+n}}return t||void 0}function Tt(){this.__d=!0}function gr(e,t){return{__v:e,context:t,props:e.props,setState:Tt,forceUpdate:Tt,__d:!0,__h:new Array(0)}}var Ge,Z,le,ae;var $e={},Mt=[],Y=Array.isArray,Fe=Object.assign,M="",he="<!--$s-->",ge="<!--/$s-->";function br(e,t,r){var o=d[Ee];d[Ee]=!0,Ge=d.__b,Z=d[sr],le=d.__r,ae=d.unmount;var i=dt(R,null);i[Rt]=[e];try{var n=j(e,t||$e,!1,void 0,i,!1,r);return Y(n)?n.join(M):n}catch(a){throw a.then?new Error('Use "renderToStringAsync" for suspenseful rendering.'):a}finally{d[xt]&&d[xt](e,Mt),d[Ee]=o,Mt.length=0}}function Ct(e,t){var r,o=e.type,i=!0;return e[K]?(i=!1,(r=e[K]).state=r[X]):r=new o(e.props,t),e[K]=r,r.__v=e,r.props=e.props,r.context=t,Et(r),r.state==null&&(r.state=$e),r[X]==null&&(r[X]=r.state),o.getDerivedStateFromProps?r.state=Fe({},r.state,o.getDerivedStateFromProps(r.props,r.state)):i&&r.componentWillMount?(r.componentWillMount(),r.state=r[X]!==r.state?r[X]:r.state):!i&&r.componentWillUpdate&&r.componentWillUpdate(),le&&le(e),r.render(r.props,r.state,t)}function j(e,t,r,o,i,n,a){if(e==null||e===!0||e===!1||e===M)return M;var l=typeof e;if(l!="object")return l=="function"?M:l=="string"?_e(e):e+M;if(Y(e)){var c,u=M;i[Rt]=e;for(var f=e.length,s=0;s<f;s++){var y=e[s];if(y!=null&&typeof y!="boolean"){var p,x=j(y,t,r,o,i,n,a);typeof x=="string"?u+=x:(c||(c=new Array(f)),u&&c.push(u),u=M,Y(x)?(p=c).push.apply(p,x):c.push(x))}}return c?(u&&c.push(u),c):u}if(e.constructor!==void 0)return M;e.__=i,Ge&&Ge(e);var g=e.type,_=e.props;if(typeof g=="function"){var b,m,k,G=t;if(g===R){if("tpl"in _){for(var H=M,F=0;F<_.tpl.length;F++)if(H+=_.tpl[F],_.exprs&&F<_.exprs.length){var D=_.exprs[F];if(D==null)continue;typeof D!="object"||D.constructor!==void 0&&!Y(D)?H+=D:H+=j(D,t,r,o,e,n,a)}return H}if("UNSTABLE_comment"in _)return"<!--"+_e(_.UNSTABLE_comment)+"-->";m=_.children}else{if((b=g.contextType)!=null){var O=t[b.__c];G=O?O.props.value:b.__}var I=g.prototype&&typeof g.prototype.render=="function";if(I)m=Ct(e,G),k=e[K];else{e[K]=k=gr(e,G);for(var ne=0;wt(k)&&ne++<25;){fr(k),le&&le(e);try{m=g.call(k,_,G)}catch(T){throw n&&T&&typeof T.then=="function"&&(e._suspended=!0),T}}Et(k)}if(k.getChildContext!=null&&(t=Fe({},t,k.getChildContext())),I&&d.errorBoundaries&&(g.getDerivedStateFromError||k.componentDidCatch)){m=m!=null&&m.type===R&&m.key==null&&m.props.tpl==null?m.props.children:m;try{return j(m,t,r,o,e,n,!1)}catch(T){return g.getDerivedStateFromError&&(k[X]=g.getDerivedStateFromError(T)),k.componentDidCatch&&k.componentDidCatch(T,$e),wt(k)?(m=Ct(e,t),(k=e[K]).getChildContext!=null&&(t=Fe({},t,k.getChildContext())),j(m=m!=null&&m.type===R&&m.key==null&&m.props.tpl==null?m.props.children:m,t,r,o,e,n,a)):M}finally{Z&&Z(e),ae&&ae(e)}}}m=m!=null&&m.type===R&&m.key==null&&m.props.tpl==null?m.props.children:m;try{var w=j(m,t,r,o,e,n,a);return Z&&Z(e),d.unmount&&d.unmount(e),e._suspended?typeof w=="string"?he+w+ge:Y(w)?(w.unshift(he),w.push(ge),w):w.then(function(T){return he+T+ge}):w}catch(T){if(!n&&a&&a.onError){var N=(function xe(ue){return a.onError(ue,e,function(J,Yt){try{return j(J,t,r,o,Yt,n,a)}catch(Kt){return xe(Kt)}})})(T);if(N!==void 0)return N;var et=d.__e;return et&&et(T,e),M}if(!n||!T||typeof T.then!="function")throw T;return T.then(function xe(){try{var ue=j(m,t,r,o,e,n,a);return e._suspended?he+ue+ge:ue}catch(J){if(!J||typeof J.then!="function")throw J;return J.then(xe)}})}}var U,z="<"+g,A=M;for(var v in _){var S=_[v];if(typeof(S=vr(S)?S.value:S)!="function"||v==="class"||v==="className"){switch(v){case"children":U=S;continue;case"key":case"ref":case"__self":case"__source":continue;case"htmlFor":if("for"in _)continue;v="for";break;case"className":if("class"in _)continue;v="class";break;case"defaultChecked":v="checked";break;case"defaultSelected":v="selected";break;case"defaultValue":case"value":switch(v="value",g){case"textarea":U=S;continue;case"select":o=S;continue;case"option":o!=S||"selected"in _||(z+=" selected")}break;case"dangerouslySetInnerHTML":A=S&&S.__html;continue;case"style":typeof S=="object"&&(S=hr(S));break;case"acceptCharset":v="accept-charset";break;case"httpEquiv":v="http-equiv";break;default:if(St.test(v))v=v.replace(St,"$1:$2").toLowerCase();else{if(kt.test(v))continue;v[4]!=="-"&&!mr.has(v)||S==null?r?cr.test(v)&&(v=v==="panose1"?"panose-1":v.replace(/([A-Z])/g,"-$1").toLowerCase()):ur.test(v)&&(v=v.toLowerCase()):S+=M}}S!=null&&S!==!1&&(z=S===!0||S===M?z+" "+v:z+" "+v+'="'+(typeof S=="string"?_e(S):S+M)+'"')}}if(kt.test(g))throw new Error(g+" is not a valid HTML tag name in "+z+">");if(A||(typeof U=="string"?A=_e(U):U!=null&&U!==!1&&U!==!0&&(A=j(U,t,g==="svg"||g!=="foreignObject"&&r,o,e,n,a))),Z&&Z(e),ae&&ae(e),!A&&yr.has(g))return z+"/>";var ye="</"+g+">",ve=z+">";return Y(A)?[ve].concat(A,[ye]):typeof A!="string"?[ve,A,ye]:ve+A+ye}var yr=new Set(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),L=br;function vr(e){return e!==null&&typeof e=="object"&&typeof e.peek=="function"&&"value"in e}var P={};oe(P,{afterDomContentLoaded:()=>Ft,afterGameScriptsRun:()=>Lt,afterJQueryLoaded:()=>Sr,afterThirdpartyScriptsRun:()=>$t,importHHPlusPlusConfig:()=>Pr,querySelector:()=>Tr,querySelectorAll:()=>Mr,run:()=>wr});var Ae=new Promise(e=>{document.readyState==="loading"?window.addEventListener("DOMContentLoaded",()=>e(),{capture:!0,once:!0}):e()}),xr=new Promise(e=>{window.$!=null?e():Ae.then(()=>{window.$!=null&&e()})}),Gt=new Promise(e=>{Ae.then(()=>{$(()=>{e()})})}),kr=new Promise(e=>{Gt.then(()=>{$(()=>{e()})})});function Sr(){return xr}function Ft(){return Ae}function Lt(){return Gt}function $t(){return kr}function wr(e){return new Promise(t=>{queueMicrotask(()=>{Promise.resolve(e()).then(t)})})}async function Pr(){return window.hhPlusPlusConfig||(await Ft(),window.hhPlusPlusConfig)||(await Lt(),window.hhPlusPlusConfig)||await $t(),window.hhPlusPlusConfig}function Tr(e,t){return new Promise(r=>{let o=()=>{let n=e.querySelector(t),a=n!==null;return a&&r(n),a};if(o())return;let i=new MutationObserver(n=>{n.every(a=>a.addedNodes.length===0)||o()&&i.disconnect()});i.observe(e,{childList:!0,subtree:!0})})}function Mr(e,t){return new Promise(r=>{let o=()=>{let n=e.querySelectorAll(t),a=n.length>0;return a&&r(n),a};if(o())return;let i=new MutationObserver(n=>{n.every(a=>a.addedNodes.length===0)||o()&&i.disconnect()});i.observe(e,{childList:!0,subtree:!0})})}var ee={};oe(ee,{getChanceColor:()=>Cr,getLPointsColor:()=>Er,getMojoColor:()=>Rr,getPDPointsColor:()=>Gr,getRoundsColor:()=>Fr});function V(e,t,r){return e<=t?t:e>=r?r:e}function At(e){return Math.round(255*Math.sqrt(V(e,0,1)))}function se(e){let t=At(2-2*e),r=At(2*e);return`rgb(${t}, ${r}, 0)`}function Cr(e){let t=V(e,0,1)**3;return se(t)}function Rr(e){let t=V(e+10,0,40)/40;return t=.5-.5*Math.cos(t**2*Math.PI),se(t)}function Er(e){let t=((V(e,3,25)-3)/22)**3;return se(t)}function Gr(e){let t=V(e/10,0,1)**3;return se(t)}function Fr(e){let t=V((100-e)/20,0,1);return se(t)}var E={};oe(E,{startsWith:()=>Lr});function Lr(e){return window.location.pathname.startsWith(e)}var C={};oe(C,{injectToHead:()=>$r});function $r(e){return $("<style />").addClass("pdsim-style").html(e).appendTo(document.head)}var Ht=`.pdsim-resource-box{width:100%;height:0;position:relative}.pdsim-resource-box #drill_energy{position:absolute;bottom:6rem;left:38%;right:38%}.pdsim-resource-box #drill_energy.energy_counter span[rel=count_txt]{margin-top:0}
`;var Dr=0;function h(e,t,r,o,i,n){t||(t={});var a,l,c=t;if("ref"in c)for(l in c={},t)l=="ref"?a=t[l]:c[l]=t[l];var u={type:e,props:c,key:r,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Dr,__i:-1,__u:0,__source:i,__self:n};if(typeof e=="function"&&(a=e.defaultProps))for(l in a)c[l]===void 0&&(c[l]=a[l]);return d.vnode&&d.vnode(u),u}var Dt={key:"CompactRewardsModule",label:"Add Resouce Bar on pre-battle page",default:!0,async run(){E.startsWith("/penta-drill-pre-battle")&&(C.injectToHead(Ht),await P.afterDomContentLoaded(),$(".penta-drill-pre-battle-container").append(L(h("div",{className:"pdsim-resource-box",children:h("div",{id:"drill_energy",className:"energy_counter",type:"drill"})}))))}};var Nt=`body.page-penta-drill-battle .popup_wrapper #rewards_popup .flex-container .rewards .container .scrolling_area,body.page-penta-drill-battle .popup_wrapper #rewards_popup .flex-container .rewards .container .rewards_scrollable,body.page-penta-drill-battle .popup_wrapper #rewards_popup .flex-container .rewards .rewards_background{max-height:unset}body.page-penta-drill-battle #rewards_big_header:not(.losing){zoom:.4}body.page-penta-drill-battle .popup_wrapper #rewards_popup .flex-container .rewards .container .rewards_scrollable{zoom:.65}
`;var Bt={key:"CompactRewardsModule",label:"Compact battle rewards",default:!0,run(){E.startsWith("/penta-drill-battle.html")&&C.injectToHead(Nt)}};var jt=`#named-attack-background,#named-attack-container,.pvp-girls{pointer-events:none}
`;var It={key:"FasterSkipButtonModule",label:"Make the skip button appear faster",default:!0,settings:[{key:"clickableSkipButton",default:!0,label:"Skip button remains clickable even during skill triggering"}],async run(e){E.startsWith("/penta-drill-battle.html")&&(e.clickableSkipButton&&C.injectToHead(jt),await P.afterDomContentLoaded(),$(document).ajaxComplete((t,r,o)=>{let{url:i,data:n}=o;i?.startsWith("/ajax.php")&&typeof n=="string"&&n.includes("action=do_battles_penta_drill")&&$(".skip-buttons-container").attr("style","")}))}};var Ut=`body.page-edit-penta-drill-team .harem-panel .harem-panel-girls{padding:0;grid-row-gap:0;grid-template-columns:repeat(5,58px)}body.page-edit-penta-drill-team .harem-panel-girls .harem-girl-container{width:58px;height:80px}
`;var Wt=`body.page-edit-penta-drill-team #edit-team-page.penta-drill .harem-panel .panel-body .harem-panel-girls .harem-girl-container:not(.selected)[team_slot] .grey-overlay{pointer-events:none}
`;var Ot=`#shortcut-bar-box{position:absolute;right:408px;width:fit-content;display:flex;flex-direction:row;gap:.35rem;padding:.7rem 1px .7rem .7rem;border-radius:.7rem 0 0 .7rem;background-color:#4f222e;z-index:1}#shortcut-bar-box .shortcut-bar{display:flex;flex-direction:column}#shortcut-bar-box .shortcut-bar .check-btn.element-state{width:38px;height:38px;padding:0}#shortcut-bar-box .shortcut-bar .check-btn.element-state .role-icn{width:36px;height:36px;background-size:27px}@media(min-width:1026px){#shortcut-bar-box{top:113px}}@media(max-width:1025px){#shortcut-bar-box{top:134px}}
`;var zt={key:"TeamEditingTweaksModule",label:"Team editing tweaks",default:!0,settings:[{key:"compactGrid",default:!0,label:"Compact grid"},{key:"tooltipOnLocked",default:!0,label:"Show tooltip on locked girl"},{key:"shortcutBar",default:!0,label:"Add shortcut bar"}],async run(e){if(!(!E.startsWith("/edit-penta-drill-team")&&!E.startsWith("/edit-labyrinth-team.html"))&&(e.compactGrid&&C.injectToHead(Ut),e.tooltipOnLocked&&C.injectToHead(Wt),e.shortcutBar&&C.injectToHead(Ot),await P.afterDomContentLoaded(),e.shortcutBar)){let t={};window.availableGirls.forEach(n=>{t[n.id_girl]=n});let o=L(h("div",{id:"shortcut-bar-box",className:"checkbox-group",children:[h("div",{className:"shortcut-bar skill",children:[h("button",{className:"check-btn element-state",value:"all",tooltip:"All"}),tt.map((n,a)=>{let l=ot[n],c=nt[l];return h("button",{className:"check-btn element-state",value:n,tooltip:c,children:h("span",{className:`role-icn ${l}_icn`})},a)})]}),h("div",{className:"shortcut-bar role",children:[h("button",{className:"check-btn element-state",value:"all",tooltip:"All Roles"}),rt.map((n,a)=>h("button",{className:"check-btn element-state",value:n,"role-tooltip":n,children:h("span",{className:`role-icn girl_role_${n}_icn`})},a))]})]})),i=$(o);i.insertAfter(".change-team-panel.harem-panel"),i.find(".role button.check-btn").each((n,a)=>{let l=a,c=l.value;$(l).on("click",()=>{let u=$("select#filter_role");u.length===0&&(u=$('select[name="role"]')),u.prop("value",c).selectric("refresh").change()})}),i.find(".skill button.check-btn").each((n,a)=>{let l=a,c=l.value;$(l).on("click",()=>{let u=$("select#filter_element");u.length===0&&(u=$('select[name="element"]')),u.prop("value",c).selectric("refresh").change();let f=$("select#filter_skill_tier");c==="all"?f.prop("value","all").selectric("refresh").change():f.prop("value",5).selectric("refresh").change()})})}}};function He(e){let{is_hero:t}=e;return e.fighters.map(r=>{let o=r.map(l=>Or(l)),i=o.map(l=>l.id_girl),n=Object.fromEntries(o.map(l=>[l.id_girl,l]));return{ids:i,is_hero:t,list:o,map:n,front:[2,3].map(l=>o[l]).filter(l=>l!=null),middle:[0,1,4].map(l=>o[l]).filter(l=>l!=null),back:[5,6].map(l=>o[l]).filter(l=>l!=null),reassurance_summary:[],pleasurelock_damage:0}})}function De(e){return e.team.map(t=>Wr(t,e.is_hero))}function Wr(e,t){let r=e.girls.map(n=>zr(n,t)),o=r.map(n=>n.id_girl),i=Object.fromEntries(r.map(n=>[n.id_girl,n]));return{ids:o,is_hero:t,list:r,map:i,front:[2,3].map(n=>r[n]).filter(n=>n!=null),middle:[0,1,4].map(n=>r[n]).filter(n=>n!=null),back:[5,6].map(n=>r[n]).filter(n=>n!=null),reassurance_summary:[],pleasurelock_damage:0}}function Or(e){return{id_girl:e.id_girl,is_hero_fighter:e.is_hero_fighter,damage:e.damage,defense:e.defense,chance:e.chance,speed:e.speed,id_role:e.girl.girl.id_role,trigger_skill:e.trigger_skill,initial_defense:e.defense,initial_ego:e.initial_ego,mana_starting:e.remaining_mana,remaining_ego:e.initial_ego,remaining_mana:e.remaining_mana,total_shields_amount:e.total_shields_amount,is_defeated:!1,burn_summary:[],stun_summary:0}}function zr(e,t){let r=e.battle_caracs;return{id_girl:e.id_girl,is_hero_fighter:t,damage:r.damage,defense:r.defense,chance:r.chance,speed:r.speed,id_role:e.girl.id_role,trigger_skill:qr(e),initial_defense:r.defense,initial_ego:r.ego,mana_starting:r.mana_starting,remaining_ego:r.ego,remaining_mana:r.mana_starting,total_shields_amount:0,is_defeated:!1,burn_summary:[],stun_summary:0}}function qr(e){return[15,16,17,18,19,20,21,22].reduce((t,r)=>t??e.skills[r]?.skill,void 0)??{id_skill:23,level:0,skill_type:"light_punch",flat_value:null,percentage_value:50}}function qt(e){e.forEach(t=>Zr(t))}function Zr(e){e.list.forEach(t=>Jr(t)),e.reassurance_summary=[],e.pleasurelock_damage=0}function Jr(e){e.defense=e.initial_defense,e.remaining_ego=e.initial_ego,e.remaining_mana=e.mana_starting,e.total_shields_amount=0,e.is_defeated=!1,e.burn_summary=[],e.stun_summary=0}function te(e,t){e.total_shields_amount>=t?e.total_shields_amount-=t:(e.remaining_ego-=t-e.total_shields_amount,e.total_shields_amount=0,e.remaining_ego<=0&&(e.is_defeated=!0))}function Zt(e){return e.list.filter(t=>!t.is_defeated).reduce((t,r)=>t.remaining_ego<=r.remaining_ego?t:r)}function Qr({attacker:e}){if(e.burn_summary.length>0){let t=e.burn_summary[0];t.rounds_left--,te(e,t.damage),t.rounds_left<=0&&e.burn_summary.shift()}}function Xr(){}var Ne={simulate:Qr,validate:Xr};function Yr({attacker:e}){return e.stun_summary>0?(e.stun_summary--,{isStunned:!0}):{isStunned:!1}}function Kr(){}var Be={simulate:Yr,validate:Kr};function Vr(e){e.forEach(t=>{t.reassurance_summary.forEach(r=>{r.rounds_left--,r.rounds_left<=0&&r.buffs.forEach(([o,i])=>{o.defense-=i})}),t.reassurance_summary=t.reassurance_summary.filter(r=>r.rounds_left<=0)})}function en(){}var je={simulate:Vr,validate:en};function Ie(e,t){let r=.3*e.chance/(e.chance+t.chance);return Math.random()<r}function re(e){return e[Math.floor(e.length*Math.random())]}function W(e,t){if(e.length<=t)return e;let r=[];return Array(t).keys().forEach(()=>{let o=Math.floor(Math.random()*e.length);r.push(e[o]),e[o]=e[e.length-1],e.length--}),r}function tn({attacker:e,defenderTeam:t}){let r=e.trigger_skill.flat_value,o=e.trigger_skill.percentage_value/100,i=t.list.filter(n=>!n.is_defeated);i=W(i,2),i.forEach(n=>{let a=Math.ceil(n.initial_ego*o);n.burn_summary.push({damage:a,rounds_left:r})}),e.remaining_mana-=100}function rn(){}var Ue={simulate:tn,validate:rn};function nn({attacker:e,defenderTeam:t}){let o=.1+e.trigger_skill.level*.035;if(Math.random()<o){let i=t.list.filter(n=>!n.is_defeated);i=W(i,2),i.forEach(n=>{n.stun_summary+=2}),e.remaining_mana-=100}}function on(){}var We={simulate:nn,validate:on};function an({attacker:e,attackerTeam:t}){let r=e.trigger_skill.flat_value,o=t.list.filter(i=>i!=e&&!i.is_defeated);o=W(o,2),o.forEach(i=>{i.remaining_mana+=r}),e.remaining_mana-=100}function ln(){}var Oe={simulate:an,validate:ln};function sn({attacker:e,defenderTeam:t}){let r=e.trigger_skill.percentage_value/100,o=t.list.filter(n=>n.remaining_mana>0),i=Math.floor(r*o.reduce((n,a)=>{let l=Math.floor(a.remaining_mana*r);return a.remaining_mana-=l,n+a.remaining_mana+l},0));e.remaining_mana=Math.min(100,e.remaining_mana-100+i)}function un(){}var ze={simulate:sn,validate:un};function cn({attacker:e,attackerTeam:t}){let r=e.trigger_skill.flat_value,o=e.trigger_skill.percentage_value/100,n=t.list.filter(a=>!a.is_defeated).map(a=>{let l=Math.ceil(a.initial_defense*o);return a.defense+=l,[a,l]});t.reassurance_summary.push({buffs:n,rounds_left:r}),e.remaining_mana-=100}function mn(){}var qe={simulate:cn,validate:mn};function fn({attacker:e,attackerTeam:t}){let r=e.trigger_skill.percentage_value/100;t.list.filter(o=>!o.is_defeated).forEach(o=>{let i=Math.ceil(o.initial_ego*r);e.is_hero_fighter||(i=Math.ceil(i*.05)),o.remaining_ego=Math.min(o.initial_ego,o.remaining_ego+i)}),e.remaining_mana-=100}function pn(){}var Ze={simulate:fn,validate:pn};function dn({attacker:e,attackerTeam:t}){let r=t.list.filter(o=>o.is_defeated);if(r.length){let o=re(r),i=e.remaining_ego;e.is_hero_fighter||(i=Math.ceil(i*.05)),o.remaining_ego+=i,o.remaining_ego>0&&(o.is_defeated=!1),e.remaining_mana-=100}}function _n(){}var Je={simulate:dn,validate:_n};function hn({attacker:e,attackerTeam:t}){let r=e.trigger_skill.percentage_value/100,o=t.list.filter(i=>i!=e&&!i.is_defeated&&i.total_shields_amount>=i.initial_ego);o=W(o,3),o.forEach(i=>{let n=Math.ceil(i.initial_ego*r);i.total_shields_amount=Math.min(i.initial_ego,i.total_shields_amount+n)}),e.remaining_mana-=100}function gn(){}var Qe={simulate:hn,validate:gn};function bn({attacker:e,defenderTeam:t}){let r=e.trigger_skill.percentage_value/100,o=t.list.filter(a=>!a.is_defeated),i=re(o),n=Math.ceil(e.damage*r)-i.defense;n=Math.max(0,n),te(i,n),e.remaining_mana-=100}function yn(){}var be={simulate:bn,validate:yn};function Ye(e,t,r){let o=Array(11).fill(0),i=0,n=0,a=Number.MAX_SAFE_INTEGER,l=0;for(let c=0;c<r;c++){[e,t].forEach(s=>qt(s));let{points:u,rounds:f}=vn(e,t);o[u]++,i+=u,n+=f,a=Math.min(a,f),l=Math.max(l,f)}return{points:i/r,pointTable:o.map(c=>c/r),rounds:n/r,minRounds:a,maxRounds:l}}function vn(e,t){let r=Math.min(e.length,t.length),o=0,i=0,n=0;for(let a=0;a<r;a++){let l=e[a],c=t[a],u=xn(l,c,i);o+=u.points,n+=u.rounds-i,i=u.rounds,u.points===1&&(i=0)}return{points:o,rounds:n}}function xn(e,t,r){let o=[...t.list.map(i=>({attacker:i,attackerTeam:t,defenderTeam:e,heroTeam:e,opponentTeam:t})),...e.list.map(i=>({attacker:i,attackerTeam:e,defenderTeam:t,heroTeam:e,opponentTeam:t}))];o.sort((i,n)=>n.attacker.speed-i.attacker.speed);for(let i=r+1;i<=100;i++){let n=kn(o);if(n.isOver)return{points:n.points,rounds:i}}return{points:1,rounds:100}}function kn(e){for(let t=0,r=e.length;t<r;t++){let o=e[t%r];t===0&&je.simulate([o.attackerTeam,o.defenderTeam]);let i=Sn(o);if(i.isOver)return i}return{isOver:!1}}function Sn(e){let{attacker:t,attackerTeam:r,defenderTeam:o}=e;if(t.is_defeated)return{isOver:!1};let{isStunned:i}=Be.simulate(e);if(!i){if(t.id_role===ie.Fluffer){let{noHeal:n}=Tn(e);n&&Qt(e)}else Qt(e);if(wn(e),Xe(o)||(Pn(e),Xe(o)))return Jt(t.is_hero_fighter)}return Ne.simulate({attacker:t}),Xe(r),{isOver:!1}}function Jt(e){return{isOver:!0,points:e?2:0}}function Xe(e){return e.list.every(t=>t.is_defeated)}function wn({attacker:e}){if(e.remaining_mana<100){let t=e.id_role===ie.Spermcaster?35:20;e.remaining_mana+=t,e.remaining_mana>100&&(e.remaining_mana=100)}}function Pn(e){let{attacker:t}=e;if(t.remaining_mana>=100){let r=t.trigger_skill,o={...e,level:r.level,flat:r.flat_value,percentage:r.percentage_value/100};if(t.id_role===10)Je.simulate(o);else{let n=r.id_skill;n===15&&be.simulate(o),n===16&&Ze.simulate(o),n===17&&ze.simulate(o),n===18&&Qe.simulate(o),n===19&&Ue.simulate(o),n===20&&Oe.simulate(o),n===21&&qe.simulate(o),n===22&&We.simulate(o),n===23&&be.simulate(o)}}}function Tn({attacker:e,attackerTeam:t}){let r=t.list.filter(n=>n!==e&&!n.is_defeated&&n.remaining_ego<n.initial_ego);if(r.length===0)return{noHeal:!0};let o=r.length===1?r[0]:r.reduce((n,a)=>n.remaining_ego<=a.remaining_ego?n:a),i=e.damage;return Ie(e,o)&&(i+=Math.max(0,e.damage-o.defense)),e.is_hero_fighter||(i=Math.ceil(i*.05)),i=Math.min(i,o.initial_ego-o.remaining_ego),o.remaining_ego+=i,{noHeal:!1}}function Qt({attacker:e,defenderTeam:t}){let r;if(e.id_role===ie.Corkscrewer)r=Zt(t);else{let i=t.front.filter(n=>!n.is_defeated);i.length==0&&(i=t.middle.filter(n=>!n.is_defeated)),i.length==0&&(i=t.back.filter(n=>!n.is_defeated)),r=re(i)}let o=Math.max(0,e.damage-r.defense);Ie(e,r)&&(e.id_role===ie.Bugger?o=Math.ceil(o*2.4):o*=2),te(r,o)}var Ke=`.pdsim-result-box{position:relative;width:100%;height:0}.pdsim-result-box .pdsim-result{position:absolute;width:max-content;height:0;line-height:1.25rem;text-align:center;text-shadow:-1px -1px 0 #000,-1px 1px 0 #000,1px -1px 0 #000,1px 1px 0 #000;z-index:1}.pdsim-result-box .pdsim-result .pdsim-label{font-size:.75rem}.pdsim-result-box .pdsim-result.pdsim-pending{color:#999}.penta-drill-battle .pdsim-result-box .pdsim-result{bottom:3rem}.penta-drill-battle .pdsim-result-box .pdsim-result.pdsim-right{right:0}.penta-drill-battle .pdsim-result-box .pdsim-result.pdsim-left{left:0}.opponent-info-container .pdsim-result-box .pdsim-result{bottom:3.5rem}.opponent-info-container .pdsim-result-box .pdsim-result.pdsim-right{right:10%}.opponent-info-container .pdsim-result-box .pdsim-result.pdsim-left{left:10%}
`;var Xt={key:"PentaDrillSimModule",label:"Penta Drill Sim",default:!0,settings:[{key:"arena",default:!0,label:"Run on table page"},{key:"preBattle",default:!0,label:"Run on pre-battle page"},{key:"heavy",default:!1,label:"Heavy simulation (slow)"},{key:"developer",default:!0,label:"Developer mode"}],async run(e){if(e.arena&&E.startsWith("/penta-drill-arena.html")){C.injectToHead(Ke),await P.afterDomContentLoaded();let{player_datas:r,opponents_list:o}=window;if(r==null||o==null){console.log("Not found",{player_datas:r,opponents_list:o});return}let i=e.heavy?300:100;o.forEach(n=>{P.run(async()=>{let a=De(r),l=De(n.player),c=Ye(a,l,i);await P.afterGameScriptsRun();let u=t(c),f=$(`a[href$="id_opponent=${n.player.id_fighter}"]`);f.length===0&&(f=$(`a[href*="id_opponent=${n.player.id_fighter}&"]`)),f.parent().after(u),await P.afterThirdpartyScriptsRun(),u.parent().find("#perform_opponent").length>0&&(u.find(".pdsim-right").css("right",0),u.find(".pdsim-left").css("left",0))})})}if(E.startsWith("/penta-drill-pre-battle")&&(await P.afterDomContentLoaded(),C.injectToHead(Ke),e.preBattle)){let{hero_fighter:r,opponent_fighter:o}=window;if(r==null||o==null){console.log("Not found",{hero_fighter:r,opponent_fighter:o});return}let i=e.heavy?1e3:100,n=He(r),a=He(o),l=Ye(n,a,i);await P.afterGameScriptsRun();let c=t(l);$(".opponent_rewards").after(c)}function t(r){let o=$(L(h("div",{className:"pdsim-result-box"}))),i=$(L(h("div",{className:"pdsim-result pdsim-left"}))).html(L(h(R,{children:[h("div",{className:"pdsim-label",children:"E[Points]:"}),h("span",{className:"pdsim-points",children:r.points.toFixed(2)})]}))).attr("tooltip",L(h("table",{children:r.pointTable.map((a,l)=>[l,a]).filter(([a,l])=>l>0).map(([a,l])=>h("tr",{style:{color:ee.getPDPointsColor(a)},children:[h("td",{children:a}),h("td",{children:":"}),h("td",{children:[(100*l).toFixed(0),"%"]})]},a))}))).css("color",ee.getPDPointsColor(r.points)),n=$(L(h("div",{className:"pdsim-result pdsim-right"}))).html(L(h(R,{children:[h("div",{className:"pdsim-label",children:"E[Rounds]:"}),h("span",{className:"pdsim-rounds",children:r.rounds.toFixed(1)})]}))).attr("tooltip",`${r.minRounds} - ${r.maxRounds}`).css("color",ee.getRoundsColor(r.maxRounds));return o.append(i),o.append(n),o}}};(async function(){"use strict";await P.afterJQueryLoaded();let e=Object.values(Ve);if(await P.importHHPlusPlusConfig()&&r())return;e.forEach(o=>{if(o.default){let i=o.settings?.reduce((n,a)=>(n[a.key]=a.default,n),{})??{};o.run(i)}});return;function r(){let{hhPlusPlusConfig:o}=window;if(!o)return!1;let i="pdsim";return o.registerGroup({key:i,name:"PD Sim"}),e.forEach(n=>{!n||!n.run||o.registerModule({group:i,configSchema:{baseKey:n.key,label:n.label,default:n.default??!0,subSettings:n.settings},hasRun:!1,run(a){if(!this.hasRun){let l=n.run(a);this.hasRun=!0,Promise.resolve(l).then(c=>{this.hasRun=c!==!1})}},tearDown(){this.hasRun&&n.undo&&(this.hasRun=n.undo()===!1)}})}),o.loadConfig(),o.runModules(),!0}})();})();
